[tox]
minversion = 2.1
envlist = py311
# CI: skip-next-line
skipsdist = true
# CI: skip-next-line
skip_missing_interpreters = true

[testenv:local-integration]
# CI: skip-next-line
usedevelop = true
install_command =
  pip install -U {opts} {packages}
setenv =
  VIRTUAL_ENV={envdir}
  LANGUAGE=en_US
  LC_ALL=en_US.utf-8
  PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python
deps = -rrequirements-dev.txt
commands =
  pip install ../client
  pip check
  python -m pytest -v --order-dependencies --ignore=./staging


[testenv:staging-integration]
# CI: skip-next-line
usedevelop = true
install_command =
  pip install -U {opts} {packages}
setenv =
  VIRTUAL_ENV={envdir}
  LANGUAGE=en_US
  LC_ALL=en_US.utf-8
  PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python
deps = -rrequirements-dev.txt
passenv =
    QISKIT_IBM_TOKEN
    QISKIT_IBM_INSTANCE
    QISKIT_IBM_URL_STAGING
commands =
  pip install ../client
  pip check
  python -m pytest ./staging

[testenv:lint]
deps = -rrequirements-dev.txt
commands =
  black --diff --check .
  pylint -rn docker/test_* docker/conftest.py

[testenv:black]
skip_install = true
commands = black .